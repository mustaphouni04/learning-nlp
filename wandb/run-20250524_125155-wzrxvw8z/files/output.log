/home/melaichouni/Desktop/learning-nlp/asho_project.py:49: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
Epoching:   0%|                                                                                                                                                                                                                                                                                 | 0/5 [00:00<?, ?it/s]/home/melaichouni/Desktop/learning-nlp/asho_project.py:57: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():                                                                                                                                                                                                                                                                            | 0/944 [00:00<?, ?it/s]
Passing a tuple of `past_key_values` is deprecated and will be removed in Transformers v4.48.0. You should pass an instance of `EncoderDecoderCache` instead, e.g. `past_key_values=EncoderDecoderCache.from_legacy_cache(past_key_values)`.
 53%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                               | 502/944 [02:28<02:10,  3.39it/s]
Epoching:   0%|                                                                                                                                                                                                                                                                                 | 0/5 [02:28<?, ?it/s]
Traceback (most recent call last):
  File "/home/melaichouni/Desktop/learning-nlp/asho_project.py", line 61, in <module>
    scaler.scale(loss).backward()
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/torch/_tensor.py", line 648, in backward
    torch.autograd.backward(
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/torch/autograd/__init__.py", line 353, in backward
    _engine_run_backward(
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/torch/autograd/graph.py", line 824, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/melaichouni/Desktop/learning-nlp/asho_project.py", line 61, in <module>
    scaler.scale(loss).backward()
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/torch/_tensor.py", line 648, in backward
    torch.autograd.backward(
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/torch/autograd/__init__.py", line 353, in backward
    _engine_run_backward(
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/torch/autograd/graph.py", line 824, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7fe9594ed510>
Traceback (most recent call last):
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/home/melaichouni/.virtualenvs/dev/lib/python3.10/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/usr/lib/python3.10/threading.py", line 1096, in join
    self._wait_for_tstate_lock()
  File "/usr/lib/python3.10/threading.py", line 1116, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt:
